// Code generated by smithy-swift-codegen. DO NOT EDIT!

import ClientRuntime

extension S3Storage: Codable, Reflection {
    enum CodingKeys: String, CodingKey {
        case aWSAccessKeyId = "AWSAccessKeyId"
        case bucket = "bucket"
        case prefix = "prefix"
        case uploadPolicy = "uploadPolicy"
        case uploadPolicySignature = "uploadPolicySignature"
    }

    public func encode(to encoder: Encoder) throws {
        var container = encoder.container(keyedBy: Key.self)
        if let aWSAccessKeyId = aWSAccessKeyId {
            try container.encode(aWSAccessKeyId, forKey: Key("AWSAccessKeyId"))
        }
        if let bucket = bucket {
            try container.encode(bucket, forKey: Key("Bucket"))
        }
        if let prefix = prefix {
            try container.encode(prefix, forKey: Key("Prefix"))
        }
        if let uploadPolicy = uploadPolicy {
            try container.encode(uploadPolicy.base64EncodedString(), forKey: Key("UploadPolicy"))
        }
        if let uploadPolicySignature = uploadPolicySignature {
            try container.encode(uploadPolicySignature, forKey: Key("UploadPolicySignature"))
        }
    }

    public init (from decoder: Decoder) throws {
        let containerValues = try decoder.container(keyedBy: CodingKeys.self)
        let aWSAccessKeyIdDecoded = try containerValues.decodeIfPresent(String.self, forKey: .aWSAccessKeyId)
        aWSAccessKeyId = aWSAccessKeyIdDecoded
        let bucketDecoded = try containerValues.decodeIfPresent(String.self, forKey: .bucket)
        bucket = bucketDecoded
        let prefixDecoded = try containerValues.decodeIfPresent(String.self, forKey: .prefix)
        prefix = prefixDecoded
        if containerValues.contains(.uploadPolicy) {
            do {
                let uploadPolicyDecoded = try containerValues.decodeIfPresent(Data.self, forKey: .uploadPolicy)
                uploadPolicy = uploadPolicyDecoded
            } catch {
                uploadPolicy = "".data(using: .utf8)
            }
        } else {
            uploadPolicy = nil
        }
        let uploadPolicySignatureDecoded = try containerValues.decodeIfPresent(String.self, forKey: .uploadPolicySignature)
        uploadPolicySignature = uploadPolicySignatureDecoded
    }
}
